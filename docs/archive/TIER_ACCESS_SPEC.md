# 티어별 접근 권한 명세

## 티어 시스템 개요

| Tier | 역할 | 권한 레벨 |
|------|------|----------|
| 1 | 최고 관리자 (원장) | 시스템 전체 제어 |
| 2 | 관리자 (강사) | 담당 클래스 관리 |
| 3-A | 정회원 (수강생) | 게시판, 수강 자료 접근 |
| 3-B | 학부모 | 자녀 정보 조회 전용 |
| 3-C | 명예회원 | 수료생 커뮤니티 |
| 4 | 비정규회원 | 제한적 읽기/쓰기 |
| 5 | 게스트 | 학원 소개만 열람 |

---

## 페이지별 접근 권한

### 1. 홈페이지 (`/`)
- **접근 가능**: 전체 (Tier 5 포함)
- **기능**: 학원 소개, 과정 안내, 상담 문의

### 2. 로그인/회원가입 (`/auth`)
- **접근 가능**: 비로그인 사용자
- **기능**: 로그인, 회원가입

### 3. 관리자 대시보드 (`/admin`)
- **접근 가능**: Tier 1, 2 (관리자/강사)
- **Tier 1 전용 기능**:
  - ✅ 학생 추가/삭제
  - ✅ 클래스 생성/삭제
  - ✅ CMS 콘텐츠 관리 (`/admin/cms`)
  - ✅ 전체 데이터 분석 (`/admin/analytics`)
  - ✅ 시스템 설정 (`/admin/settings`)
- **Tier 2 기능**:
  - ✅ 담당 클래스 조회
  - ✅ 담당 학생 출석 관리
  - ❌ 시스템 설정 접근 불가
  - ❌ CMS 수정 불가

### 4. 학생 대시보드 (`/student`)
- **접근 가능**: Tier 3-A (정회원 수강생)
- **기능**:
  - ✅ 내 클래스 조회
  - ✅ 출석 현황
  - ✅ 진행 중인 프로젝트
  - ✅ 알림 확인
  - ✅ LMS 강의실 접근
  - ✅ 커뮤니티 읽기/쓰기

### 5. 학부모 대시보드 (`/parent`)
- **접근 가능**: Tier 3-B (학부모)
- **기능**:
  - ✅ 자녀 정보 조회 (읽기 전용)
  - ✅ 자녀 출결 확인
  - ✅ 커리큘럼 진행도 확인
  - ✅ 상담 신청
  - ❌ 커뮤니티 글쓰기 불가
  - ❌ LMS 접근 불가

### 6. LMS 강의실 (`/lms`)
- **접근 가능**: Tier 1, 2, 3-A
- **Tier 3-A**: 수강 중인 강의만 접근
- **Tier 2**: 담당 강의 접근 + 관리 기능
- **Tier 1**: 전체 강의 접근

### 7. 커뮤니티 (`/community`)
- **접근 가능**: Tier 1, 2, 3-A, 3-C
- **Tier 3-A**: 읽기/쓰기 가능
- **Tier 3-B (학부모)**: 읽기 전용
- **Tier 3-C (명예회원)**: 읽기/쓰기 가능 (수료생 전용 게시판)
- **Tier 4**: 읽기 전용

### 8. 프로젝트 협업 (`/collab`)
- **접근 가능**: Tier 1, 2, 3-A
- **기능**: 프로젝트 생성, 팀원 초대, 파일 공유

### 9. 키오스크 출석 (`/kiosk`)
- **접근 가능**: 전체 (공용 단말기)
- **기능**: 출석 체크만

---

## 현재 구현 상태

### ✅ 구현 완료
- [x] AuthContext 구조 (`/src/contexts/AuthContext.tsx`)
- [x] Tier 기반 권한 체크 함수 (`hasPermission`, `isRole`)
- [x] 페이지별 UI 구현

### ⚠️ 미구현 (프론트엔드에서 추가 필요)
- [ ] AuthProvider를 layout.tsx에 통합
- [ ] 각 페이지에서 useAuth 훅 사용
- [ ] 권한별 UI 조건부 렌더링
- [ ] ProtectedRoute 컴포넌트
- [ ] 티어별로 보이는 메뉴/버튼 필터링

### 🔒 백엔드 영역 (건들지 않음)
- 실제 JWT 토큰 검증
- 데이터베이스 권한 체크
- API 엔드포인트 보호
- 세션 관리

---

## 프론트엔드 권한 체크가 필요한 이유

1. **UX 개선**: 접근 불가능한 메뉴를 미리 숨겨 혼란 방지
2. **보안 1차 방어**: 백엔드가 최종 검증하지만, 프론트엔드에서도 필터링
3. **API 호출 최소화**: 권한 없는 요청을 미리 차단

---

## 구현 우선순위

### Phase 1: AuthProvider 통합 (필수)
1. layout.tsx에 AuthProvider 추가
2. Mock 로그인으로 티어 테스트

### Phase 2: ProtectedRoute (필수)
1. 페이지별 필요 티어 정의
2. 권한 없을 시 리다이렉트

### Phase 3: UI 조건부 렌더링 (중요)
1. 관리자 전용 버튼 숨기기 (CMS, 학생 추가 등)
2. 티어별 사이드바 메뉴 필터링
3. 학부모는 읽기 전용 UI

### Phase 4: 상세 권한 체크 (추가)
1. 담당 클래스만 보이기 (Tier 2)
2. 수강 중인 강의만 보이기 (Tier 3-A)
